<!DOCTYPE html>
<html>
  <head>
    <script src="jquery-1.12.1.js"></script>
    <script src="./bootstrap.js"></script>
    <script src="./bootstrap-select.js"></script>
    <link rel="stylesheet" href="./bootstrap.css"/>
    <link rel="stylesheet" href="./bootstrap-select.css"/>
  </head>
  <body>
    <div style="text-align:center">
      <h2>Adidas ReStock</h2>
      <p> This app will monitor shoe quantity for 24 hours and will text you if your size is restocked.</p>
    </div>
    <div class="jumbotron col-sm-6 col-sm-offset-3" style="text-align:center">
      <div class="container">
        <div class="form-group" style="text-align:center">
          <input class="form-control" id="productId" style="width: 220px; margin:auto" placeholder="Product ID"></input>
          <br>
          <input class="form-control" style="width: 220px; margin:auto" id="phoneNumber" placeholder="Phone Number"></input>
        </div>
        <select class="selectpicker" id="size" style="margin: auto; text-align: center" title="Size">
          <option>4</option>
          <option>4.5</option>
          <option>5</option>
          <option>5.5</option>
          <option>6</option>
          <option>6.5</option>
          <option>7</option>
          <option>7.5</option>
          <option>8</option>
          <option>8.5</option>
          <option>9</option>
          <option>9.5</option>
          <option>10</option>
          <option>10.5</option>
          <option>11</option>
          <option>11.5</option>
          <option>12</option>
          <option>13</option>
          <option>14</option>
          <option>15</option>
          <option>16</option>
          <option>17</option>
          <option>18</option>
        </select>
        <br>
        <div class="radio" id="gender">
          <label><input type="radio" name="gender" value="male">Male Item</label>
          <label><input type="radio" name="gender" value="female">Female Item</label>
        </div>
        <button class="btn btn-success" onClick="submit()">Notify Me</button>
        <br>
        <br>
        <p id="status"></p>
      </div>
    </div>
    <script>

      function submit() {
        console.log('submitting')
        var s = document.getElementById('size')
        var strUser = s.options[s.selectedIndex].value
        var productId = document.getElementById('productId').value.toUpperCase()
        var number = document.getElementById('phoneNumber').value.replace(/\D/g, '')
        var gender = document.querySelector('input[name="gender"]:checked') === null ? null : document.querySelector('input[name="gender"]:checked').value
        if(productId.length <= 3) {
          document.getElementById('status').innerHTML = 'Please input a correct Product ID'
        } else if(number.length !== 11) {
          document.getElementById('status').innerHTML = 'Please input a correct Phone Number // Format: 14159528888'
        } else if(strUser === "") {
          document.getElementById('status').innerHTML = 'Please select a size'
        } else if(gender === null) {
          document.getElementById('status').innerHTML = 'Please select a gender'
        }  else {
          document.getElementById('status').innerHTML = ''
          $.ajax({
            url: 'https://adistockcheck.herokuapp.com/check',
            type: 'POST',
            data: {'size': strUser, 'productId': productId, 'gender': gender, 'number': number},
            success: function (response) {
              document.getElementById('status').innerHTML = response
            },
            error: function (response) {
              console.log(response)
            }
          })
        }
      }

    </script>
  </body>
</html>
